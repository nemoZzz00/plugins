!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.ISelect=t()}(this,function(){var e=function(e){return this.ele="object"==typeof e.ele?e.ele:document.querySelector(e.ele),this.select=null,this.headBox=null,this._title=null,this.list=null,this.listBox=null,this.useStyle=e.useStyle||!1,this.hideCb=e.hideCb instanceof Function?e.hideCb:null,this.showCb=e.showCb instanceof Function?e.showCb:null,this.chooseCb=e.chooseCb instanceof Function?e.chooseCb:null,this.ready=e.ready instanceof Function?e.ready:null,this.destroyCb=e.destroyCb instanceof Function?e.destroyCb:null,this.body=document.querySelector("body"),this.html=null,this.value=null,this.disabled=!1,this.$data={},this.ele.multiple?void console.warn("暂不支持多选select!"):(this.init(),this)};return e.prototype={constructor:e,init:function(){this.create(),this.linkage(),this.appendDoc(),this.toggle(),this.choose(),this.readyStatus()},create:function(){this.select=document.createElement("div"),this.select.classList.add("select-pull-down"),this.headBox=document.createElement("div"),this.headBox.classList.add("select-down-head"),this._title=document.createElement("p"),this._title.classList.add("select-title"),this.listBox=document.createElement("ul"),this.listBox.classList.add("select-list-down");var e=document.createElement("i");e.classList.add("select-arrow-down"),this.headBox.appendChild(this._title),this.headBox.appendChild(e),this.select.appendChild(this.headBox),this.select.appendChild(this.listBox)},appendDoc:function(){var e=this.ele.innerHTML,t=this;if(e=e.replace(/<(?:option)(.*?)>([\s\S]*?)<\/(?:option)>/gi,function(e,t,s){return"<li"+t+">"+s+"</li>"}),t.listBox.innerHTML=e,t.list=t.listBox.querySelectorAll("li"),t.value=t.getText().value,t.disabled=t.getText().disabled,t.useStyle){var s=getComputedStyle(t.ele);t.select.style.width=s.width,t.select.style.height=s.height,t.select.style.lineHeight=s.height}t.ele.style.display="none",t.ele.parentNode.insertBefore(t.select,t.ele)},toggle:function(){var e=this.select,t=this;t.showFn=function(s){t.select.classList.contains("disabled")||(this.classList.contains("active")?(this.classList.remove("active"),t.select.classList.remove("select-top"),t.hideCb&&t.hideCb(s)):(this.classList.add("active"),t.htmlCH=document.documentElement.clientHeight||document.body.clientHeight,t.htmlST=document.documentElement.scrollTop||document.body.scrollTop,t.boxH=t.listBox.offsetHeight,t.eleH=e.offsetHeight,t.eleT=t.util.offsetTop(e)-t.htmlST,t.overH=t.htmlCH-t.eleH-t.eleT,t.overH<t.boxH&&t.select.classList.add("select-top"),t.showCb&&t.showCb(s)))},t.bodyFn=function(s){if(!t.select.classList.contains("disabled")){for(var i=!0,l=e.parentElement.querySelectorAll("*"),n=0;n<l.length;n++){var o=l[n];o==s.target&&(i=!1)}i&&e.classList.contains("active")&&(e.classList.remove("active"),t.hideCb&&t.hideCb(s))}},e.removeEventListener("click",t.showFn,!1),e.addEventListener("click",t.showFn,!1),t.body.removeEventListener("click",t.bodyFn,!1),t.body.addEventListener("click",t.bodyFn,!1)},choose:function(){for(var e=this,t=0;t<e.list.length;t++)e.list[t].addEventListener("click",function(t){for(var s=0;s<e.list.length;s++)e.list[s].removeAttribute("selected");this.setAttribute("selected",""),e.value=this.getAttribute("value"),e.chooseCb&&e.chooseCb(this,t)},!1);e.ele.addEventListener("input",function(){var t=e.getText();e.value=t.value})},getText:function(){var e=this.ele.selectedIndex,t=this.ele.options[e],s=this.ele.disabled;return{html:t.innerHTML,value:t.value,disabled:s}},setSelect:function(e){var t=this;t.select.setAttribute("value",e)},getSelect:function(){var e=this.select,t=this._title;return{html:t.innerHTML,value:e.getAttribute("value"),disabled:e.classList.contains("disabled")}},linkage:function(){var e=this;Object.defineProperties(e,{$data:{enumerable:!1,configurable:!1},value:{configurable:!0,enumerable:!0,set:function(t){for(var s=e.ele.options,i=0,l=0;l<s.length;l++)s[l].value!=t&&i++;if(i==s.length)throw new Error("刷新失败:在下拉项中并未找到value="+t+"的option!");e.ele.value=t;var n=e.getText().html;e.setSelect(t),e.html=n,e.$data.newValue=t},get:function(){return e.$data.newValue}},html:{configurable:!0,enumerable:!0,set:function(t){e._title.innerHTML=t,e.select.setAttribute("title",t),e.$data.newHtml=t},get:function(){return e.$data.newHtml}},disabled:{configurable:!0,enumerable:!0,set:function(t){t?(e.select.classList.add("disabled"),e.ele.disabled=!0,e.select.classList.contains("active")?e.select.classList.remove("active"):null):(e.select.classList.remove("disabled"),e.ele.disabled=!1),e.$data.newDisabled=t},get:function(){return e.$data.newDisabled}}})},watch:function(){var e={html:this.html,value:this.value,disabled:this.disabled},t=this.getText(),s=this.getSelect(),i={};for(var l in t)e.hasOwnProperty(l)&&"html"!=l&&(e[l]==t[l]&&e[l]==s[l]?i[l]=e[l]:e[l]!=t[l]&&e[l]!=s[l]?i[l]=t[l]:e[l]!=s[l]?i[l]=s[l]:e[l]!=t[l]&&(i[l]=t[l]));return i},refresh:function(){var e=this.watch();for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t])},destroy:function(){this.select.destroy||(this.body.removeEventListener("click",this.bodyFn,!1),this.select.removeEventListener("click",this.showFn,!1),this.select.parentNode.removeChild(this.select),this.select.destroy=!0,this.ele.style.display="block",this.destroyCb&&this.destroyCb())},readyStatus:function(){this.ready&&this.ready()},util:{offsetTop:function(e){for(var t=e.offsetParent,s=e.offsetTop;t;)s+=t.clientTop,s+=t.offsetTop,t=t.offsetParent;return s}}},e});